[
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2022-01-01", 
                                                "vaccineCode": { "coding": [ { "code": "212" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": true
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "212" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": false
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-06-31", 
                                                "vaccineCode": { "coding": [ { "code": "212" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "212" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": true
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-06-31", 
                                                "vaccineCode": { "coding": [ { "code": "212" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": true
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-06-31", 
                                                "vaccineCode": { "coding": [ { "code": "212" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-08-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-10-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "180" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": true
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-06-31", 
                                                "vaccineCode": { "coding": [ { "code": "212" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-08-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-10-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "30" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": false
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2022-01-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": false,
        "comment": "expected is FALSE because for double dose vaccines we always expect second record and it is not there"
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-10-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": true
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-10-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": false
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-10-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-11-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "208" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": true
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-10-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-11-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "208" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "7" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": false
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-06-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-07-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-08-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-09-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-10-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "208" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "0" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": true
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-06-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-07-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-08-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-09-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-10-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-01-31", 
                                                "vaccineCode": { "coding": [ { "code": "208" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "7" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "999" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": false
    },
    {
        "data": {
            "payload": {
                "vc": {
                    "credentialSubject": {
                        "fhirBundle": {
                            "entry": [
                                {},
                                { "resource": { "occurrenceDateTime" : "2021-06-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-07-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2022-08-31", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-09-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-10-01", 
                                                "vaccineCode": { "coding": [ { "code": "207" } ] } } },
                                { "resource": { "occurrenceDateTime" : "2021-11-01", 
                                                "vaccineCode": { "coding": [ { "code": "208" } ] } } }
                            ]
                        }
                    }
                }
            },
            "external": {
                "validationClock": "2022-02-01T10:00:00Z",
                "vaccinationValidAfterDaysBOOSTER": [ "14" ],
                "vaccinationValidityDurationDaysBOOSTER": [ "90" ],
                "vaccinationValidAfterDays": [ "14" ],
                "vaccinationValidityDurationDays": [ "180" ],
                "approvedVaccinesUSDoubleDose": [ "207", "208", "210", "212", "217", "218", "219", "502", "510", "511" ],
                "approvedVaccinesUSSingleDose": [ "212" ]
            }
        },
        "expectedResult": false
    }
]